"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5],{55885:function(L,p,r){r.r(p);var O=r(97857),l=r.n(O),j=r(5574),m=r.n(j),u=r(67294),f=r(55742),_=r(34041),E=r(71577),P=r(90063),g=r(96974),a=r(85893),y=function(){var M=(0,u.useState)([]),v=m()(M,2),d=v[0],x=v[1],A=(0,u.useState)([]),D=m()(A,2),i=D[0],c=D[1],b=(0,u.useState)("all"),C=m()(b,2),h=C[0],S=C[1],T=(0,g.s0)();(0,u.useEffect)(function(){fetch("/api/rollcall?lesson_id="+window.location.search.split("=")[1]).then(function(e){return e.json()}).then(function(e){x(e);var t=e.map(function(n){return l()(l()({},n),{},{status:"present"})});c(t)}).catch(function(e){return console.error("Error fetching data:",e)})},[]),(0,u.useEffect)(function(){var e=d;h!=="all"&&(e=d.filter(function(t){return t.adminclass_name===h})),c(e)},[h,d]);var U=function(t,n){var o=i.map(function(s){return s.code===t.code?l()(l()({},s),{},{status:n,other:n==="absent"?"late":void 0}):s});c(o)},B=function(t,n){var o=i.map(function(s){return s.code===t.code?l()(l()({},s),{},{other:n}):s});c(o)},I=function(){var t={data:i.map(function(n){return{code:n.code,name:n.name,adminclass_name:n.adminclass_name,result:n.other||"present"}})};fetch("/api/result?lesson_id="+window.location.search.split("=")[1],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(n){return n.json()}).then(function(n){T("/result?result_id=".concat(n.data.result_id))}).catch(function(n){return console.error("Error posting data:",n)})},R=function(){window.location.href="/"},K=[{title:"\u59D3\u540D",dataIndex:"name",key:"name"},{title:"\u72B6\u6001",dataIndex:"status",key:"status",render:function(t,n){return(0,a.jsxs)(f.ZP.Group,{value:t,onChange:function(s){return U(n,s.target.value)},children:[(0,a.jsx)(f.ZP,{value:"present",children:"\u5DF2\u5230"}),(0,a.jsx)(f.ZP,{value:"absent",children:"\u672A\u5230"})]})}},{title:"\u5176\u4ED6",dataIndex:"other",key:"other",render:function(t,n){return(0,a.jsxs)(_.Z,{value:t,onChange:function(s){return B(n,s)},disabled:n.status!=="absent",children:[(0,a.jsx)(_.Z.Option,{value:"leave",children:"\u8BF7\u5047"}),(0,a.jsx)(_.Z.Option,{value:"late",children:"\u8FDF\u5230"})]})}}],Z=Array.from(new Set(d.map(function(e){return e.adminclass_name})));return(0,a.jsxs)("div",{style:{margin:"10px"},children:[(0,a.jsx)(E.ZP,{type:"primary",onClick:R,children:"\u4E3B\u9875"}),(0,a.jsxs)(_.Z,{value:h,style:{width:200,marginBottom:20,float:"right"},onChange:function(t){return S(t)},children:[(0,a.jsx)(_.Z.Option,{value:"all",children:"\u5168\u90E8\u73ED\u7EA7"}),Z.map(function(e){return(0,a.jsx)(_.Z.Option,{value:e,children:e},e)})]}),(0,a.jsx)(P.Z,{dataSource:i,columns:K,rowKey:"code"}),(0,a.jsx)("div",{style:{textAlign:"center"},children:(0,a.jsx)(E.ZP,{type:"primary",onClick:I,children:"\u63D0\u4EA4"})})]})};p.default=y}}]);
